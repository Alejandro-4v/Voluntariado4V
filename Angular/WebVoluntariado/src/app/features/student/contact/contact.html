
<main class="dashboard-content bg-light py-5">
  <div class="container-lg">

    @if (isLoading) {
    <app-loading-spinner [text]="'Cargando información de contacto...'"></app-loading-spinner>
    } @else {
    <div @fadeIn>
      
      <div class="mb-5" @slideUp>
        <h1 class="display-5 fw-bold mb-2 text-dark">
          Centro de Ayuda
        </h1>
        <p class="text-muted lead">
          ¿Tienes algún problema o duda? Contacta con las entidades o infórmanos sobre una actividad.
        </p>
      </div>

      
      <section class="mb-5" @slideUp>
        <h2 class="fs-4 fw-bold mb-4 text-dark">
          Contactar con una Entidad
        </h2>
        <p class="text-muted mb-4">
          Haz clic en una entidad para ver sus datos de contacto.
        </p>

        @if (entities.length > 0) {
        <app-carrousel [items]="entities" cardType="entity" (cardClick)="openEntityModal($event)">
        </app-carrousel>
        } @else {
        <div class="alert alert-light border shadow-sm" role="alert">
          No hay entidades disponibles en este momento.
        </div>
        }
      </section>

      <hr class="my-5 text-muted opacity-25">

      
      <section class="mb-5" @slideUp>
        <h2 class="fs-4 fw-bold mb-4 text-dark">
          Problemas con Próximas Actividades
        </h2>
        <p class="text-muted mb-4">
          Si tienes dudas sobre una actividad en la que vas a participar o quieres cancelar tu inscripción.
        </p>

        @if (upcomingActivities.length > 0) {
        <app-carrousel [items]="upcomingActivities" cardType="activity" (cardClick)="openActivityModal($event)">
        </app-carrousel>
        } @else {
        <div class="alert alert-light border shadow-sm" role="alert">
          No tienes actividades próximas.
        </div>
        }
      </section>

      
      <section class="mb-5" @slideUp>
        <h2 class="fs-4 fw-bold mb-4 text-dark">
          Reportar Actividades Pasadas
        </h2>
        <p class="text-muted mb-4">
          Si tuviste algún incidente en una actividad pasada.
        </p>

        @if (allActivities.length > 0) {
        <app-carrousel [items]="allActivities" cardType="activity" (cardClick)="openActivityModal($event)">
        </app-carrousel>
        } @else {
        <div class="alert alert-light border shadow-sm" role="alert">
          No tienes actividades pasadas.
        </div>
        }
      </section>

    </div>
    }
  </div>
</main>


<app-activity-modal [isOpen]="isModalOpen" [activity]="selectedActivity" buttonType="informar"
  (close)="closeActivityModal()" (action)="onActivityAction()">
</app-activity-modal>



@if (selectedEntity) {
<div class="modal-overlay" (click)="closeEntityModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="modal-close" (click)="closeEntityModal()">×</button>
    <div class="modal-body text-center p-4">
      @if (selectedEntity.perfilUrl) {
      <img [src]="selectedEntity.perfilUrl" class="rounded-circle mb-3 shadow-sm" width="100" height="100"
        style="object-fit: cover;">
      }
      <h2 class="fw-bold mb-1">{{ selectedEntity.nombre }}</h2>
      <p class="text-muted mb-4">
        {{ selectedEntity.nombreResponsable }} {{ selectedEntity.apellidosResponsable }}
        <br>
        <small>Responsable</small>
      </p>

      <div class="d-grid gap-3">
        <a [href]="'mailto:' + selectedEntity.contactMail" class="btn btn-primary btn-lg">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
            class="bi bi-envelope-fill me-2" viewBox="0 0 16 16">
            <path
              d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z" />
          </svg>
          Enviar Correo
        </a>
      </div>
    </div>
  </div>
</div>
}