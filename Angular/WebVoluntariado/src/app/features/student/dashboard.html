<!-- Main content -->
<main class="dashboard-content bg-white py-5">
  <div class="container-lg">

    <!-- Loading Spinner -->
    @if (isLoading) {
    <app-loading-spinner [text]="'Cargando panel de estudiante...'"></app-loading-spinner>
    } @else {
    <div @fadeIn>

      <div class="mb-5" @slideUp>
        <h1 class="display-6 fw-bold mb-2 text-dark">
          Nuevas actividades de entidades en las que participas
        </h1>
      </div>

      <!-- Grouped Activities by Entity -->
      @for (group of groupedActivities; track group.entityName) {
      <section class="mb-5" @slideUp>
        <h2 class="fs-5 fw-bold mb-4 text-dark">
          Nuevas actividades desde {{ group.entityName }}
        </h2>
        <app-carrousel [items]="group.activities" (cardClick)="openActivityModal($event)">
        </app-carrousel>
      </section>
      } @empty {
      <div class="alert alert-info mb-5" @slideUp>
        No hay nuevas actividades de tus entidades.
      </div>
      }

      <!-- Proposals from Cuatrovientos -->
      <section class="mb-5" @slideUp>
        <h2 class="fs-5 fw-bold mb-4 text-dark">
          Propuestas desde Cuatrovientos
        </h2>
        @if (proposalsFromCuatrovientos.length > 0) {
        <app-carrousel [items]="proposalsFromCuatrovientos" cardType="proposal" (cardClick)="openActivityModal($event)">
        </app-carrousel>
        } @else {
        <p class="text-muted">No hay propuestas activas en este momento.</p>
        }
      </section>

      <!-- Other Entities -->
      <section class="mb-5" @slideUp>
        <h2 class="fs-5 fw-bold mb-4 text-dark">
          Otras entidades que te pueden interesar
        </h2>
        @if (otherEntities.length > 0) {
        <app-carrousel [items]="otherEntities" cardType="entity">
        </app-carrousel>
        } @else {
        <p class="text-muted">No hay otras entidades disponibles.</p>
        }
      </section>

    </div>
    }

  </div>
</main>

<!-- Activity Modal -->
<app-activity-modal [isOpen]="isModalOpen" [activity]="selectedActivity" (close)="closeActivityModal()"
  (action)="onActivityAction()">
</app-activity-modal>