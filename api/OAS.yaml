openapi: 3.1.0
info:
  title: Volutariado 4V - OpenAPI 1.0
  contact:
    email: alejandrolopez2048@gmail.com
  version: beta
servers:
  - url: http://localhost:80
tags:
  - name: Actividades
    description: Todo en relación a las actividades de la asociación, sus voluntarios y las entidades que lo organizan
  - name: Voluntarios
    description: Todo en relación a los voluntarios de la asociación (alumnos del centro) con los tipos de actividades que les interesan y grados a los que pertenecen
  - name: Entidad
    description: Todo en relación a las entidades de la asociación que organizan actividades
  - name: Tipos de actividad
    description: Todo en relación a los tipos de actividad con los que una actividad cumple o con los que un voluntarios está interesado
  - name: Grado
    description: Todo en relación a los grados del centro
  - name: ODS
    description: Todo en relación a las ODS que aparecen en las actividades
  - name: Log in
    description: Inicio de sesión de voluntarios, entidades o administradores.
paths:
  /actividad:
    get:
      tags:
        - Actividades
      summary: Devuelve todas las actividades ordenadas por fecha descendente con un parámetro para regular la cantidad devuelta
      parameters:
        - in: query
          name: limit
          schema:
            type: integer
          required: false
          description: Número de items a devolver ordenados por fecha descendente
          example: 10
        - in: query
          name: nombre
          schema:
            type: string
          required: false
          description: Filtro por nombre de la actividad
        - in: query
          name: lugar
          schema:
            type: string
          required: false
          description: Filtro por lugar de la actividad
        - in: query
          name: estado
          schema:
            type: string
          required: false
          description: Filtro por estado de la actividad
        - in: query
          name: convoca
          schema:
            type: integer
          required: false
          description: Filtro por ID de la entidad que convoca
        - in: query
          name: fecha
          schema:
            type: string
            format: date
          required: false
          description: Filtro por fecha de la actividad
        - in: query
          name: grado
          schema:
            type: integer
          required: false
          description: Filtro por ID del grado
        - in: query
          name: tiposActividad
          style: form
          explode: false
          schema:
            type: array
            items:
              type: integer
          required: false
          description: Filtro por IDs de tipos de actividad
        - in: query
          name: ods
          style: form
          explode: false
          schema:
            type: array
            items:
              type: integer
          required: false
          description: Filtro por IDs de ODS
      responses:
        '200':
          description: Actividades encontradas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Actividad'
    post:
      tags:
        - Actividades
      summary: Crea una nueva actividad
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Actividad_DTO'
      responses:
        '201':
          description: Actividad creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Actividad'

  /actividad/{idActividad}:
    get:
      tags:
        - Actividades
      summary: Devuelve una actividad por su ID
      parameters:
        - in: path
          name: idActividad
          schema:
            type: integer
          required: true
          description: ID de la actividad
      responses:
        '200':
          description: Actividad encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Actividad'
        '404':
          description: Actividad no encontrada
    put:
      tags:
        - Actividades
      summary: Actualiza una actividad existente
      parameters:
        - in: path
          name: idActividad
          schema:
            type: integer
          required: true
          description: ID de la actividad a actualizar
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Actividad_DTO'
      responses:
        '200':
          description: Actividad actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Actividad'
        '404':
          description: Actividad no encontrada
    delete:
      tags:
        - Actividades
      summary: Elimina una actividad
      parameters:
        - in: path
          name: idActividad
          schema:
            type: integer
          required: true
          description: ID de la actividad a eliminar
      responses:
        '204':
          description: Actividad eliminada
        '404':
          description: Actividad no encontrada

  /voluntario:
    get:
      tags:
        - Voluntarios
      summary: Devuelve todos los voluntarios con filtros opcionales
      parameters:
        - in: query
          name: nombre
          schema:
            type: string
          required: false
          description: Filtro por nombre del voluntario
        - in: query
          name: apellidos
          schema:
            type: string
          required: false
          description: Filtro por apellidos del voluntario
        - in: query
          name: grado
          schema:
            type: integer
          required: false
          description: Filtro por ID del grado
        - in: query
          name: estado
          schema:
            type: string
          required: false
          description: Filtro por estado del voluntario
        - in: query
          name: dias
          style: form
          explode: false
          schema:
            type: array
            items:
              type: integer
          required: false
          description: Filtro por días de disponibilidad (IDs de días)
        - in: query
          name: horaInicio
          schema:
            type: string
            format: time
          required: false
          description: Filtro por hora de inicio de disponibilidad
        - in: query
          name: horaFin
          schema:
            type: string
            format: time
          required: false
          description: Filtro por hora de fin de disponibilidad
        - in: query
          name: tiposActividad
          style: form
          explode: false
          schema:
            type: array
            items:
              type: integer
          required: false
          description: Filtro por IDs de tipos de actividad
      responses:
        '200':
          description: Voluntarios encontrados
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Voluntario'
    post:
      tags:
        - Voluntarios
      summary: Crea un nuevo voluntario
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Voluntario_DTO'
      responses:
        '201':
          description: Voluntario creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Voluntario'

  /voluntario/{nif}:
    get:
      tags:
        - Voluntarios
      summary: Devuelve un voluntario por su NIF
      parameters:
        - in: path
          name: nif
          schema:
            type: string
          required: true
          description: NIF del voluntario
      responses:
        '200':
          description: Voluntario encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Voluntario'
        '404':
          description: Voluntario no encontrado
    put:
      tags:
        - Voluntarios
      summary: Actualiza un voluntario existente
      parameters:
        - in: path
          name: nif
          schema:
            type: string
          required: true
          description: NIF del voluntario a actualizar
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Voluntario_DTO'
      responses:
        '200':
          description: Voluntario actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Voluntario'
    delete:
      tags:
        - Voluntarios
      summary: Elimina un voluntario
      parameters:
        - in: path
          name: nif
          schema:
            type: string
          required: true
          description: NIF del voluntario a eliminar
      responses:
        '204':
          description: Voluntario eliminado
        '404':
          description: Voluntario no encontrado

  /entidad:
    get:
      tags:
        - Entidad
      summary: Devuelve todas las entidades con filtros opcionales
      parameters:
        - in: query
          name: cif
          schema:
            type: string
          required: false
          description: Filtro por CIF de la entidad
        - in: query
          name: nombre
          schema:
            type: string
          required: false
          description: Filtro por nombre de la entidad
        - in: query
          name: nombreResponsable
          schema:
            type: string
          required: false
          description: Filtro por nombre del responsable (incluye búsqueda en apellidos)
        - in: query
          name: contactMail
          schema:
            type: string
          required: false
          description: Filtro por email de contacto
      responses:
        '200':
          description: Entidades encontradas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Entidad'
    post:
      tags:
        - Entidad
      summary: Crea una nueva entidad
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Entidad_DTO'
      responses:
        '201':
          description: Entidad creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Entidad'

  /entidad/{id}:
    get:
      tags:
        - Entidad
      summary: Devuelve una entidad por su ID
      parameters:
          - in: path
            name: id
            schema:
              type: integer
            required: true
            description: ID de la entidad
      responses:
        '200':
          description: Entidad encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Entidad'
        '404':
          description: Entidad no encontrada

    put:
      tags:
        - Entidad
      summary: Actualiza una entidad existente
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID de la entidad a actualizar
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Entidad_DTO'
      responses:
        '200':
          description: Entidad actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Entidad'
    delete:
      tags:
        - Entidad
      summary: Elimina una entidad
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID de la entidad a eliminar
      responses:
        '204':
          description: Entidad eliminada
        '404':
          description: Entidad no encontrada

  /tipoActividad:
    get:
      tags:
        - Tipos de actividad
      summary: Devuelve todos los tipos de actividad
      responses:
        '200':
          description: Tipos de actividad encontrados
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TipoActividad'
    post:
      tags:
        - Tipos de actividad
      summary: Crea un nuevo tipo de actividad
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TipoActividad_DTO'
      responses:
        '201':
          description: Tipo de actividad creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TipoActividad'

  /tipoActividad/{id}:
    get:
      tags:
        - Tipos de actividad
      summary: Devuelve un tipo de actividad por su ID
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID del tipo de actividad
      responses:
        '200':
          description: Tipo de actividad encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TipoActividad'
        '404':
          description: Tipo de actividad no encontrado
    put:
      tags:
        - Tipos de actividad
      summary: Actualiza un tipo de actividad existente
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID del tipo de actividad a actualizar
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TipoActividad_DTO'
      responses:
        '200':
          description: Tipo de actividad actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TipoActividad'
        '404':
          description: Tipo de actividad no encontrado
    delete:
      tags:
        - Tipos de actividad
      summary: Elimina un tipo de actividad
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID del tipo de actividad a eliminar
      responses:
        '204':
          description: Tipo de actividad eliminado
        '404':
          description: Tipo de actividad no encontrado

  /grado:
    get:
      tags:
        - Grado
      summary: Devuelve todos los grados
      responses:
        '200':
          description: Grados encontrados
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Grado'
    post:
      tags:
        - Grado
      summary: Crea un nuevo grado
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Grado_DTO'
      responses:
        '201':
          description: Grado creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Grado'

  /grado/{id}:
    get:
      tags:
        - Grado
      summary: Devuelve un grado por su ID
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID del grado
      responses:
        '200':
          description: Grado encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Grado'
        '404':
          description: Grado no encontrado
    put:
      tags:
        - Grado
      summary: Actualiza un grado existente
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID del grado a actualizar
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Grado_DTO'
      responses:
        '200':
          description: Grado actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Grado'
        '404':
          description: Grado no encontrado
    delete:
      tags:
        - Grado
      summary: Elimina un grado
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID del grado a eliminar
      responses:
        '204':
          description: Grado eliminado
        '404':
          description: Grado no encontrado

  /ods:
    get:
      tags:
        - ODS
      summary: Devuelve todas las ODS
      responses:
        '200':
          description: ODS encontradas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Ods'
    post:
      tags:
        - ODS
      summary: Crea una nueva ODS
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Ods_DTO'
      responses:
        '201':
          description: ODS creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Ods'

  /ods/{id}:
    get:
      tags:
        - ODS
      summary: Devuelve una ODS por su ID
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID de la ODS
      responses:
        '200':
          description: ODS encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Ods'
        '404':
          description: ODS no encontrada
    put:
      tags:
        - ODS
      summary: Actualiza una ODS existente
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID de la ODS a actualizar
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Ods_DTO'
      responses:
        '200':
          description: ODS actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Ods'
        '404':
          description: ODS no encontrada
    delete:
      tags:
        - ODS
      summary: Elimina una ODS
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID de la ODS a eliminar
      responses:
        '204':
          description: ODS eliminado
        '404':
          description: ODS no encontrada

  /login:
    post:
      tags:
        - Log in
      summary: Autenticación de usuario y obtención de token JWT
      parameters:
        - in: query
          name: usuario
          schema:
            type: string
            enum: [voluntario, entidad, administrador]
          required: false
          description: Tipo de usuario que inicia sesión (opcional)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LogIn'
      responses:
        '200':
          description: Autenticación exitosa
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
        '401':
          description: Credenciales inválidas
components:
  schemas:

    Actividad:
      type: object
      properties:
        idActividad:
          type: integer
          example: 1
        nombre:
          type: string
          example: Tardes de compañía
        descripcion:
          type: string
          example: Talleres sencillos de informática con residentes de la tercera edad.
        lugar:
          type: string
          example: Residencia Amavir
        estado:
          type: string
          example: A
        convoca:
          $ref: '#/components/schemas/Entidad_Actividad'
        inicio:
          type: string
          format: date-time
          example: 2025-12-01T16:00:00
        fin:
          type: string
          format: date-time
          example: 2025-12-01T18:00:00
        imagenUrl:
          type: string
          example: https://placehold.co/600x400/png?text=Tardes+de+Compa%C3%B1ia
        grado:
          $ref: '#/components/schemas/Grado'
        tiposActividad:
          type: array
          items:
            $ref: '#/components/schemas/TipoActividad'
        ods:
          type: array
          items:
            $ref: '#/components/schemas/Ods'
        voluntarios:
          type: array
          items:
            $ref: '#/components/schemas/Voluntario_Actividad'

    Actividad_DTO:
      type: object
      properties:
        nombre:
          type: string
          example: Tardes de compañía
        descripcion:
          type: string
          example: Talleres sencillos de informática con residentes de la tercera edad.
        lugar:
          type: string
          example: Residencia Amavir
        estado:
          type: string
          example: A
        convoca:
          type: integer
          example: 1
        inicio:
          type: string
          format: date-time
          example: 2025-12-01T16:00:00
        fin:
          type: string
          format: date-time
          example: 2025-12-01T18:00:00
        imagenUrl:
          type: string
          example: https://placehold.co/600x400/png?text=Tardes+de+Compa%C3%B1ia
        grado:
          type: integer
          example: 1
        tiposActividad:
          type: array
          items:
            type: integer
          example: [1, 2]
        ods:
          type: array
          items:
            type: integer
          example: [1, 3]
        voluntarios:
          type: array
          items:
            type: string
          example: ["11111111A", "22222222B"]

    Actividad_Entidad:
      type: object
      properties:
        idActividad:
          type: integer
          example: 1
        nombre:
          type: string
          example: Tardes de compañía
        descripcion:
          type: string
          example: Talleres sencillos de informática con residentes de la tercera edad.
        estado:
          type: string
          example: A
        inicio:
          type: string
          format: date-time
          example: 2025-12-01T16:00:00
        fin:
          type: string
          format: date-time
          example: 2025-12-01T18:00:00
        imagenUrl:
          type: string
          example: https://placehold.co/600x400/png?text=Tardes+de+Compa%C3%B1ia
        grado:
          $ref: '#/components/schemas/Grado'
        tiposActividad:
          type: array
          items:
            $ref: '#/components/schemas/TipoActividad'
        ods:
          type: array
          items:
            $ref: '#/components/schemas/Ods'
        voluntarios:
          type: array
          items:
            $ref: '#/components/schemas/Voluntario_Actividad'

    Voluntario:
      type: object
      properties:
        nif:
          type: string
          example: 11111111A
        nombre:
          type: string
          example: Sofía
        apellido1:
          type: string
          example: Diez
        apellido2:
          type: string
          example: Gómez
        grado:
          $ref: '#/components/schemas/Grado'
        mail:
          type: string
          example: sofia.d@mail.com
        estado:
          type: string
          enum: [A, P, R, I]
          example: P
        perfilUrl:
          type: string
          example: https://placehold.co/400/png?text=Sof%C3%ADa
        disponibilidades:
          type: array
          items:
            $ref: '#/components/schemas/Disponibilidad'
          example:
            - diaSemana:
                idDia: 1
                descripcion: Lunes
              horaInicio: 1970-01-01T15:30:00
              horaFin: 1970-01-01T17:00:00
            - diaSemana:
                idDia: 4
                descripcion: Jueves
              horaInicio: 1970-01-01T16:00:00
              horaFin: 1970-01-01T18:00:00
        tiposActividad:
          type: array
          items:
            $ref: '#/components/schemas/TipoActividad'

    Voluntario_DTO:
      type: object
      properties:
        nif:
          type: string
          example: 11111111A
        nombre:
          type: string
          example: Sofía
        apellido1:
          type: string
          example: Diez
        apellido2:
          type: string
          example: Gómez
        grado:
          type: integer
          example: 1
        mail:
          type: string
          example: sofia.d@mail.com
        password:
          type: string
          example: password
        perfilUrl:
          type: string
          example: https://placehold.co/400/png?text=Sof%C3%ADa
        disponibilidades:
          type: array
          items:
            type: object
            properties:
              idDia:
                type: integer
                example: 1
              horaInicio:
                type: string
                format: time
                example: 1970-01-01T15:30:00
              horaFin:
                type: string
                format: time
                example: 1970-01-01T17:00:00
        tiposActividad:
          type: array
          items:
            type: integer
          example: [1, 2]

    Voluntario_Actividad:
      type: object
      properties:
        nif:
          type: string
          example: 11111111A
        nombre:
          type: string
          example: Sofía
        apellido1:
          type: string
          example: Diez
        apellido2:
          type: string
          example: Gómez
        grado:
          $ref: '#/components/schemas/Grado'
        mail:
          type: string
          example: sofia.d@mail.com
        perfilUrl:
          type: string
          example: https://placehold.co/400/png?text=Sof%C3%ADa

    Entidad:
      type: object
      properties:
        idEntidad:
          type: integer
          example: 1
        cif:
          type: string
          example: B7012345A
        nombre:
          type: string
          example: Residencias Amavir
        nombreResponsable:
          type: string
          example: Laura
        apellidosResponsable:
          type: string
          example: García Pérez
        fechaRegistro:
          type: string
          format: date-time
          example: 2026-01-12T21:48:37
        contactMail:
          type: string
          example: contacto@amabir.org
        perfilUrl:
          type: string
          example: https://placehold.co/400/png?text=Amabir
        actividades:
          type: array
          items:
            $ref: '#/components/schemas/Actividad_Entidad'

    Entidad_DTO:
      type: object
      properties:
        cif:
          type: string
          example: B7012345A
        nombre:
          type: string
          example: Residencias Amavir
        nombreResponsable:
          type: string
          example: Laura
        apellidosResponsable:
          type: string
          example: García Pérez
        contactMail:
          type: string
          example: contacto@amabir.org
        loginMail:
          type: string
          example: login@amabir.org
        password:
          type: string
          example: password
        perfilUrl:
          type: string
          example: https://placehold.co/400/png?text=Amabir

    Entidad_Actividad:
      type: object
      properties:
        idEntidad:
          type: integer
          example: 1
        cif:
          type: string
          example: B7012345A
        nombre:
          type: string
          example: Residencias Amabir
        nombreResponsable:
          type: string
          example: Laura
        apellidosResponsable:
          type: string
          example: García Pérez
        contactMail:
          type: string
          example: contacto@amabir.org
        perfilUrl:
          type: string
          example: https://placehold.co/400/png?text=Amabir

    Ods:
      type: object
      properties:
        idOds:
          type: integer
          example: 1
        descripcion:
          type: string
          example: Fin de la pobreza
        imagenUrl:
          type: string
          example: https://placehold.co/400/png?text=Fin+de+la+pobreza

    Ods_DTO:
      type: object
      properties:
        descripcion:
          type: string
          example: Fin de la pobreza
        imagenUrl:
          type: string
          example: https://placehold.co/400/png?text=Fin+de+la+pobreza

    Grado:
      type: object
      properties:
        idGrado:
          type: integer
          example: 1
        nivel:
          type: string
          example: S
          enum: [M, S]
        descripcion:
          type: string
          example: Desarrollo de Aplicaciones Multiplataforma

    Grado_DTO:
      type: object
      properties:
        nivel:
          type: string
          example: S
          enum: [M, S]
        descripcion:
          type: string
          example: Desarrollo de Aplicaciones Multiplataforma

    Disponibilidad:
      type: object
      properties:
        diaSemana:
          type: object
          properties:
            idDia:
              type: integer
              example: 1
              enum: [1, 2, 3, 4, 5]
            descripcion:
              type: string
              example: Lunes
        horaInicio:
          type: string
          format: time
          example: 1970-01-01T15:30:00
        horaFin:
          type: string
          format: time
          example: 1970-01-01T17:00:00

    TipoActividad:
      type: object
      properties:
        idTipoActividad:
          type: integer
          example: 1
        descripcion:
          type: string
          example: Apoyo a Mayores
        imagenUrl:
          type: string
          example: https://placehold.co/400/png?text=Apoyo

    TipoActividad_DTO:
      type: object
      properties:
        descripcion:
          type: string
          example: Apoyo a Mayores
        imagenUrl:
          type: string
          example: https://placehold.co/400/png?text=Apoyo

    LogIn:
      type: object
      properties:
        loginMail:
          type: string
          example: admin@cuatrovientos.org
        password:
          type: string
          example: password

    Token:
      type: object
      properties:
        token:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
